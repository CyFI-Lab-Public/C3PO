#include <stdio.h>
#include <stdint.h>
#include <unistd.h>

int main(int argc, char **argv)
{
	uint32_t user_input_copy = 0;
	uint32_t *user_input_ptr = &user_input_copy;

	uint32_t user_input;
	
	fread((char *)(&user_input), 12, 1, stdin);

	sleep(5);

	// malware overwrites address of puts in GOT with address of system
	*user_input_ptr = user_input;

	char buf[1024];
	fread(buf, 1024, 1, stdin);
	puts(buf); // system should be called instead

	sleep(5);

	return 0;
}
